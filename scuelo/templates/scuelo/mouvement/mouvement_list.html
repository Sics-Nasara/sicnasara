{% extends "../../layout.html" %}

{% block content %}
    <style>
        .table-container {
            margin-bottom: 20px;
        }

        .table th, .table td {
            vertical-align: middle;
            text-align: center;
        }

        .inflow {
            color: green;
            font-weight: bold;
        }

        .outflow {
            color: red;
            font-weight: bold;
        }

        .action-links a {
            text-decoration: none;
            color: #4CAF50;
            padding: 5px 10px;
            border-radius: 3px;
            margin-right: 5px;
            transition: background-color 0.3s;
        }

        .action-links a:hover {
            background-color: #4CAF50;
            color: white;
        }

        .action-links .delete-icon {
            color: red;
        }

        .action-links .edit-icon {
            color: #4CAF50;
        }

        .add-button {
            display: inline-block;
            margin-bottom: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .add-button:hover {
            background-color: #45a049;
        }
    </style>

    <h1>Liste des Mouvements</h1>

    <a href="{% url 'add_mouvement' %}" class="add-button">Ajouter Mouvement</a>

    <form method="GET">
        <input type="text" name="search" placeholder="Rechercher" value="{{ search_query }}">
        <button type="submit">Rechercher</button>
    </form>

    <div class="table-responsive table-container w-100">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Date</th>
                    <th>Causal</th>
                    <th>Entrée (Recette)</th>
                    <th>Sortie (Dépense)</th>
                    <th>Total Progressif</th>
                    <th>Description</th> <!-- Added Description -->
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for mouvement in movements %}
                    <tr>
                        <td>{{ mouvement.id }}</td>
                        <td>{{ mouvement.date_paye }}</td>
                        <td>{{ mouvement.causal }}</td>
                        <td class="inflow">{% if mouvement.type == 'R' %}{{ mouvement.montant }}{% endif %}</td>
                        <td class="outflow">{% if mouvement.type == 'D' %}{{ mouvement.montant }}{% endif %}</td>
                        <td>{{ mouvement.progressive_total }}</td> <!-- Added Progressive Total -->
                        <td>{{ mouvement.note }}</td> <!-- Added Description (note) -->
                        <td class="action-links">
                            <a href="{% url 'update_mouvement' mouvement.pk %}" class="edit-icon">
                                <i class="fas fa-edit"></i>
                            </a>
                            <a href="{% url 'delete_mouvement' mouvement.pk %}" class="delete-icon">
                                <i class="fas fa-trash-alt"></i>
                            </a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
